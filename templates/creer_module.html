{% extends "home.html" %}

{% block title %}Créer un modèle de check-list{% endblock %}

{% block content %}
  <div class="dashboard-container">
    <h1>Créer un modèle de check-list</h1>
    <p>Ajoutez un nouveau modèle de check-list HSE.</p>

    <form method="POST" action="{{ url_for('creer_modele') }}">
      <div class="form-group">
        <label for="title">Titre du modèle</label>
        <input type="text" id="title" name="title" placeholder="Ex: Check-list EPI" required>
      </div>

      <div class="form-group">
        <label>Éléments de la check-list</label>
        <div id="elements-container">
          <div class="checklist-item-wrapper">
            <input type="text" name="elements[]" placeholder="Élément 1" required class="checklist-item-input">
            <button type="button" class="remove-btn" onclick="removeElement(this)" title="Supprimer cet élément">❌</button>
          </div>
        </div>
        <button type="button" onclick="addElement()" class="btn" style="margin-top: 10px;">+ Ajouter un élément</button>
      </div>

      <button type="submit" class="btn">Créer</button>
      <a href="{{ url_for('home') }}" class="btn-secondary">Retour</a>
    </form>
  </div>

  <script>
    function addElement() {
      const container = document.getElementById("elements-container");

      const wrapper = document.createElement("div");
      wrapper.className = "checklist-item-wrapper";

      const input = document.createElement("input");
      input.type = "text";
      input.name = "elements[]";
      input.placeholder = "Nouvel élément";
      input.required = true;
      input.className = "checklist-item-input";

      const removeBtn = document.createElement("button");
      removeBtn.type = "button";
      removeBtn.className = "remove-btn";
      removeBtn.title = "Supprimer cet élément";
      removeBtn.textContent = "❌";
      removeBtn.onclick = function() {
        removeElement(this);
      };

      wrapper.appendChild(input);
      wrapper.appendChild(removeBtn);

      container.appendChild(wrapper);
    }

    function removeElement(button) {
      const wrapper = button.parentNode;
      const container = document.getElementById("elements-container");

      if (container.children.length > 1) {
        container.removeChild(wrapper);
      } else {
        alert("La check-list doit contenir au moins un élément.");
      }
    }
  </script>
{% endblock %}
